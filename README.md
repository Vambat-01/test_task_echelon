# Тестовое задание для АО "Эшелон Технологии"

### Исходя из задания, я решил, что это будет база данных прогноза погоды, которая обновляется раз в сутки. И содержит в себе почасовой прогноз погоды для каждого города на 48 часов. При `GET` запросе содержащим в себе парамметры: название города, широту и долготу. В ответ на него будет возвращен почасовой прогноз погоды для этого города, содержащий в себе:  название города, время, широта, долгота, температура и название ресурса с которого получены данные о погоде.

## Установка зависимостей
1. Установите зависимости: pip install -r requirements.txt

## Запуск скрипта для создания и заполнения базы данных. Скрипт проходит по городам из базы и загружает погоду для каждого города с сайтов
1. Выставите переменную окружения `KEY_WEATHERBIT`:  `export KEY_WEATHERBIT=<api key for site>`
1. Выставите переменную окружения `KEY_OPENWEATHERMAP`:  `export KEY_OPENWEATHERMAP=<api key for site>`
1. Перейдите в терминале в репозитории и выполните команду: `python offline/download_weather.py`

## Запуск Web-приложения используя [Docker](https://www.docker.com/)
1. Cоздайте `Docker` образ приложения: `docker build -t test_task_echelon .`
1. Запустите `Docker` контейнер: `docker run --name task_echelon -p 8000:8000 test_task_echelon`
1. Проверка работоспособность приложения
    1. Отправьте запрос на сервер выполнив команду: `curl --location --request GET 'http://localhost:8000/api/weather?city=Le%20Creusot&latitude=46.80714&longitude=4.41632'`
        - Получите в ответ: 
        ```
        {"city":{"country":"France","latitude":46.80714,"longitude":4.41632,"name":"Le Creusot"},"entries":[{"source":"weatherbit","temperature":21.9,"timestamp":"2021-09-12T19:00:00+02:00"},{"source":"weatherbit","temperature":20,"timestamp":"2021-09-12T20:00:00+02:00"},{"source":"weatherbit","temperature":18.3,"timestamp":"2021-09-12T21:00:00+02:00"},{"source":"weatherbit","temperature":17.4,"timestamp":"2021-09-12T22:00:00+02:00"},{"source":"weatherbit","temperature":16.8,"timestamp":"2021-09-12T23:00:00+02:00"},{"source":"weatherbit","temperature":15.9,"timestamp":"2021-09-13T00:00:00+02:00"},{"source":"weatherbit","temperature":15.3,"timestamp":"2021-09-13T01:00:00+02:00"},{"source":"weatherbit","temperature":14.8,"timestamp":"2021-09-13T02:00:00+02:00"},{"source":"weatherbit","temperature":14.7,"timestamp":"2021-09-13T03:00:00+02:00"},{"source":"weatherbit","temperature":14.3,"timestamp":"2021-09-13T04:00:00+02:00"},{"source":"weatherbit","temperature":14,"timestamp":"2021-09-13T05:00:00+02:00"},{"source":"weatherbit","temperature":13.8,"timestamp":"2021-09-13T06:00:00+02:00"},{"source":"weatherbit","temperature":13.8,"timestamp":"2021-09-13T07:00:00+02:00"},{"source":"weatherbit","temperature":13.9,"timestamp":"2021-09-13T08:00:00+02:00"},{"source":"weatherbit","temperature":15.8,"timestamp":"2021-09-13T09:00:00+02:00"},{"source":"weatherbit","temperature":17.7,"timestamp":"2021-09-13T10:00:00+02:00"},{"source":"weatherbit","temperature":19.2,"timestamp":"2021-09-13T11:00:00+02:00"},{"source":"weatherbit","temperature":20.8,"timestamp":"2021-09-13T12:00:00+02:00"},{"source":"weatherbit","temperature":22.3,"timestamp":"2021-09-13T13:00:00+02:00"},{"source":"weatherbit","temperature":23.8,"timestamp":"2021-09-13T14:00:00+02:00"},{"source":"weatherbit","temperature":24.9,"timestamp":"2021-09-13T15:00:00+02:00"},{"source":"weatherbit","temperature":25.6,"timestamp":"2021-09-13T16:00:00+02:00"},{"source":"weatherbit","temperature":25.7,"timestamp":"2021-09-13T17:00:00+02:00"},{"source":"weatherbit","temperature":25.2,"timestamp":"2021-09-13T18:00:00+02:00"},{"source":"weatherbit","temperature":24.4,"timestamp":"2021-09-13T19:00:00+02:00"},{"source":"weatherbit","temperature":22.1,"timestamp":"2021-09-13T20:00:00+02:00"},{"source":"weatherbit","temperature":20.4,"timestamp":"2021-09-13T21:00:00+02:00"},{"source":"weatherbit","temperature":19.5,"timestamp":"2021-09-13T22:00:00+02:00"},{"source":"weatherbit","temperature":19.3,"timestamp":"2021-09-13T23:00:00+02:00"},{"source":"weatherbit","temperature":19,"timestamp":"2021-09-14T00:00:00+02:00"},{"source":"weatherbit","temperature":18,"timestamp":"2021-09-14T01:00:00+02:00"},{"source":"weatherbit","temperature":17,"timestamp":"2021-09-14T02:00:00+02:00"},{"source":"weatherbit","temperature":16.5,"timestamp":"2021-09-14T03:00:00+02:00"},{"source":"weatherbit","temperature":16.3,"timestamp":"2021-09-14T04:00:00+02:00"},{"source":"weatherbit","temperature":16,"timestamp":"2021-09-14T05:00:00+02:00"},{"source":"weatherbit","temperature":16,"timestamp":"2021-09-14T06:00:00+02:00"},{"source":"weatherbit","temperature":16.1,"timestamp":"2021-09-14T07:00:00+02:00"},{"source":"weatherbit","temperature":16.4,"timestamp":"2021-09-14T08:00:00+02:00"},{"source":"weatherbit","temperature":17.5,"timestamp":"2021-09-14T09:00:00+02:00"},{"source":"weatherbit","temperature":19.3,"timestamp":"2021-09-14T10:00:00+02:00"},{"source":"weatherbit","temperature":19.5,"timestamp":"2021-09-14T11:00:00+02:00"},{"source":"weatherbit","temperature":19.6,"timestamp":"2021-09-14T12:00:00+02:00"},{"source":"weatherbit","temperature":20.3,"timestamp":"2021-09-14T13:00:00+02:00"},{"source":"weatherbit","temperature":21.3,"timestamp":"2021-09-14T14:00:00+02:00"},{"source":"weatherbit","temperature":21.8,"timestamp":"2021-09-14T15:00:00+02:00"},{"source":"weatherbit","temperature":21.5,"timestamp":"2021-09-14T16:00:00+02:00"},{"source":"weatherbit","temperature":21,"timestamp":"2021-09-14T17:00:00+02:00"},{"source":"weatherbit","temperature":20.9,"timestamp":"2021-09-14T18:00:00+02:00"},{"source":"weatherbit","temperature":20.6,"timestamp":"2021-09-14T19:00:00+02:00"},{"source":"openweathermap","temperature":23.73,"timestamp":"2021-09-12T18:00:00+02:00"},{"source":"openweathermap","temperature":23.77,"timestamp":"2021-09-12T19:00:00+02:00"},{"source":"openweathermap","temperature":22.54,"timestamp":"2021-09-12T20:00:00+02:00"},{"source":"openweathermap","temperature":20.75,"timestamp":"2021-09-12T21:00:00+02:00"},{"source":"openweathermap","temperature":18.51,"timestamp":"2021-09-12T22:00:00+02:00"},{"source":"openweathermap","temperature":16.15,"timestamp":"2021-09-12T23:00:00+02:00"},{"source":"openweathermap","temperature":13.81,"timestamp":"2021-09-13T00:00:00+02:00"},{"source":"openweathermap","temperature":13.53,"timestamp":"2021-09-13T01:00:00+02:00"},{"source":"openweathermap","temperature":13.28,"timestamp":"2021-09-13T02:00:00+02:00"},{"source":"openweathermap","temperature":12.92,"timestamp":"2021-09-13T03:00:00+02:00"},{"source":"openweathermap","temperature":12.65,"timestamp":"2021-09-13T04:00:00+02:00"},{"source":"openweathermap","temperature":12.29,"timestamp":"2021-09-13T05:00:00+02:00"},{"source":"openweathermap","temperature":12.08,"timestamp":"2021-09-13T06:00:00+02:00"},{"source":"openweathermap","temperature":11.83,"timestamp":"2021-09-13T07:00:00+02:00"},{"source":"openweathermap","temperature":12.5,"timestamp":"2021-09-13T08:00:00+02:00"},{"source":"openweathermap","temperature":15.35,"timestamp":"2021-09-13T09:00:00+02:00"},{"source":"openweathermap","temperature":18.04,"timestamp":"2021-09-13T10:00:00+02:00"},{"source":"openweathermap","temperature":20.39,"timestamp":"2021-09-13T11:00:00+02:00"},{"source":"openweathermap","temperature":22.25,"timestamp":"2021-09-13T12:00:00+02:00"},{"source":"openweathermap","temperature":23.89,"timestamp":"2021-09-13T13:00:00+02:00"},{"source":"openweathermap","temperature":25.26,"timestamp":"2021-09-13T14:00:00+02:00"},{"source":"openweathermap","temperature":26.53,"timestamp":"2021-09-13T15:00:00+02:00"},{"source":"openweathermap","temperature":27.2,"timestamp":"2021-09-13T16:00:00+02:00"},{"source":"openweathermap","temperature":27.16,"timestamp":"2021-09-13T17:00:00+02:00"},{"source":"openweathermap","temperature":26.12,"timestamp":"2021-09-13T18:00:00+02:00"},{"source":"openweathermap","temperature":22.8,"timestamp":"2021-09-13T19:00:00+02:00"},{"source":"openweathermap","temperature":20,"timestamp":"2021-09-13T20:00:00+02:00"},{"source":"openweathermap","temperature":18.93,"timestamp":"2021-09-13T21:00:00+02:00"},{"source":"openweathermap","temperature":18.86,"timestamp":"2021-09-13T22:00:00+02:00"},{"source":"openweathermap","temperature":17.72,"timestamp":"2021-09-13T23:00:00+02:00"},{"source":"openweathermap","temperature":16.7,"timestamp":"2021-09-14T00:00:00+02:00"},{"source":"openweathermap","temperature":15.87,"timestamp":"2021-09-14T01:00:00+02:00"},{"source":"openweathermap","temperature":15.55,"timestamp":"2021-09-14T02:00:00+02:00"},{"source":"openweathermap","temperature":15.31,"timestamp":"2021-09-14T03:00:00+02:00"},{"source":"openweathermap","temperature":15.88,"timestamp":"2021-09-14T04:00:00+02:00"},{"source":"openweathermap","temperature":15.51,"timestamp":"2021-09-14T05:00:00+02:00"},{"source":"openweathermap","temperature":15.29,"timestamp":"2021-09-14T06:00:00+02:00"},{"source":"openweathermap","temperature":15.11,"timestamp":"2021-09-14T07:00:00+02:00"},{"source":"openweathermap","temperature":15.27,"timestamp":"2021-09-14T08:00:00+02:00"},{"source":"openweathermap","temperature":15.34,"timestamp":"2021-09-14T09:00:00+02:00"},{"source":"openweathermap","temperature":15.6,"timestamp":"2021-09-14T10:00:00+02:00"},{"source":"openweathermap","temperature":15.87,"timestamp":"2021-09-14T11:00:00+02:00"},{"source":"openweathermap","temperature":16.61,"timestamp":"2021-09-14T12:00:00+02:00"},{"source":"openweathermap","temperature":19.38,"timestamp":"2021-09-14T13:00:00+02:00"},{"source":"openweathermap","temperature":22.05,"timestamp":"2021-09-14T14:00:00+02:00"},{"source":"openweathermap","temperature":23.37,"timestamp":"2021-09-14T15:00:00+02:00"},{"source":"openweathermap","temperature":24.26,"timestamp":"2021-09-14T16:00:00+02:00"},{"source":"openweathermap","temperature":24.54,"timestamp":"2021-09-14T17:00:00+02:00"}]}
        ```
    1. Отправьте запрос на сервер выполнив команду: `curl --location --request GET 'http://localhost:8000/api/weather?city=Le%D1%81&latitude=46.80714&longitude=40.41632'`
        - Получите в ответ: `Not Found 404`